{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-02T10:06:01.868182Z", "invocation_id": "982e2a80-3a93-435d-80f7-068a0d8cf567", "invocation_started_at": "2025-12-02T10:04:29.917299Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:46.577331Z", "completed_at": "2025-12-02T10:04:46.610749Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:46.616930Z", "completed_at": "2025-12-02T10:04:47.924129Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.3634843826293945, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-2aa5-0017-bec3000ab65a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.stg_airbnb__review_S_1", "compiled": true, "compiled_code": "with airbnb_bordeaux as (\n\n    select *, 'Bordeaux', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_BORDEAUX.DBO_REVIEW\n    Where Date = To_Date('16/06/2025','DD/MM/YYYY')\n),\n\nairbnb_lyon as (\n\n    select *, 'Lyon', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_LYON.AIRBNB_REVIEW\n    Where Date = To_Date('16/06/2025','DD/MM/YYYY')\n),\n\nairbnb_paris as (\n\n    select *, 'Paris', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_PARIS.AIRBNB_REVIEW\n    Where Date = To_Date('16/06/2025','DD/MM/YYYY')\n),\n\nairbnb_pays_basque as (\n\n    select * , 'Pays Basque', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_PAYS_BASQUE.AIRBNB_REVIEW\n    Where Date = To_Date('16/06/2025','DD/MM/YYYY')\n),\n\ntable_union as (\n\n    Select *\n    From airbnb_bordeaux\n    Union all\n    Select *\n    From airbnb_lyon\n    Union all\n    Select *\n    From airbnb_paris\n    Union all\n    Select *\n    From airbnb_pays_basque\n\n)\n\nselect * from table_union", "relation_name": "AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__review_S_1", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:46.573814Z", "completed_at": "2025-12-02T10:04:46.610749Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:46.610749Z", "completed_at": "2025-12-02T10:04:47.936106Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3764677047729492, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-2aa5-0017-bec3000ab652"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.stg_airbnb__review", "compiled": true, "compiled_code": "with airbnb_bordeaux as (\n\n    select *, 'Bordeaux', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_BORDEAUX.DBO_REVIEW\n\n),\n\nairbnb_lyon as (\n\n    select *, 'Lyon', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_LYON.AIRBNB_REVIEW\n\n),\n\nairbnb_paris as (\n\n    select *, 'Paris', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_PARIS.AIRBNB_REVIEW\n\n),\n\nairbnb_pays_basque as (\n\n    select * , 'Pays Basque', Decode (Rank() Over (Partition By ID, LISTING_ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_PAYS_BASQUE.AIRBNB_REVIEW\n\n),\n\ntable_union as (\n\n    Select *\n    From airbnb_bordeaux\n    Union all\n    Select *\n    From airbnb_lyon\n    Union all\n    Select *\n    From airbnb_paris\n    Union all\n    Select *\n    From airbnb_pays_basque\n\n)\n\nselect * from table_union", "relation_name": "AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__review", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:46.560644Z", "completed_at": "2025-12-02T10:04:46.589342Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:46.589342Z", "completed_at": "2025-12-02T10:04:48.060847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5002024173736572, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-2aa5-0017-bec3000ab656"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.stg_airbnb__listing", "compiled": true, "compiled_code": "with airbnb_bordeaux as (\n\n    select * exclude(LISTING_URL), 'Bordeaux' VILLE, Decode (Rank() Over (Partition By ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_BORDEAUX.DBO_LISTING\n\n),\n\nairbnb_lyon as (\n\n    select * exclude(LISTING_URL,LIEN_URL), 'Lyon' VILLE, Decode (Rank() Over (Partition By ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_LYON.AIRBNB_LISTING\n\n),\n\nairbnb_paris as (\n\n    select *, 'Paris' VILLE, Decode (Rank() Over (Partition By ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_PARIS.AIRBNB_LISTING\n\n),\n\nairbnb_pays_basque as (\n\n    select * exclude(LISTING_URL), 'Pays Basque' VILLE, Decode (Rank() Over (Partition By ID Order BY DT_EVT Desc), 1 , 1, 0) As FG_DER_VER\n    from AIRBNB_BI_DEV.RAW_AIRBNB_PAYS_BASQUE.AIRBNB_LISTING\n\n),\n\ntable_union as (\n\n    Select *\n    From airbnb_bordeaux\n    Union all\n    Select *\n    From airbnb_lyon\n    Union all\n    Select *\n    From airbnb_paris\n    Union all\n    Select *\n    From airbnb_pays_basque\n\n)\n\nselect * from table_union", "relation_name": "AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__listing", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:47.958521Z", "completed_at": "2025-12-02T10:04:47.965336Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:47.990682Z", "completed_at": "2025-12-02T10:04:48.598668Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6457836627960205, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-26df-0017-bec30009f956"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.int_f_review", "compiled": true, "compiled_code": "with review as (\n\n    select LISTING_ID,\n\tID,\n\tDATE,\n\tCOMMENTS \n\tfrom AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__review\n\twhere FG_DER_VER = 1\n\n)\n\nselect * from review", "relation_name": "AIRBNB_BI_DEV.BI_SILVER.int_f_review", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:48.080682Z", "completed_at": "2025-12-02T10:04:48.090539Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:48.090539Z", "completed_at": "2025-12-02T10:04:48.690560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6139035224914551, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-28f9-0017-bec3000ac32e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.int_d_town", "compiled": true, "compiled_code": "with listing as (\n\n    select Distinct VILLE from AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__listing\n\n),\n\ntown as (\n\n    Select Distinct \n    Case When VILLE = 'Bordeaux' Then 1\n\t\t When VILLE = 'Lyon' Then 2\n\t\t When VILLE = 'Paris' Then 3\n\t\t When VILLE = 'Pays Basque' Then 4\n\tEnd CODE_VILLE,\n\tVILLE \n    from listing\n\n)\n\nselect * from town", "relation_name": "AIRBNB_BI_DEV.BI_SILVER.int_d_town", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:48.078684Z", "completed_at": "2025-12-02T10:04:48.084487Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:48.086904Z", "completed_at": "2025-12-02T10:04:48.725183Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6546778678894043, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-28f9-0017-bec3000ac32a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.int_d_price", "compiled": true, "compiled_code": "with listing as (\n\n    select Distinct PRICE from AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__listing\n\n),\n\nprice as (\n\n    Select Distinct \n    Case When PRICE <= 50 Then 1\n         When PRICE <= 100 Then 2\n         When PRICE <= 200 Then 3\n         When PRICE <= 500 Then 4\n         When PRICE <= 1000 Then 5\n        Else 6\n        End CODE_TR_PRICE,\n    Case When PRICE <= 50 Then '0-50\u20ac'\n         When PRICE <= 100 Then '50-100\u20ac'\n         When PRICE <= 200 Then '100-200\u20ac'\n         When PRICE <= 500 Then '200-500\u20ac'\n         When PRICE <= 1000 Then '500-1000\u20ac'\n        Else '> 1000\u20ac'\n        End TR_PRICE \n    from listing\n\n)\n\nselect * from price", "relation_name": "AIRBNB_BI_DEV.BI_SILVER.int_d_price", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:48.609493Z", "completed_at": "2025-12-02T10:04:48.613699Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:48.613699Z", "completed_at": "2025-12-02T10:04:49.290672Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6822130680084229, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-26df-0017-bec30009f95a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.int_d_type_room", "compiled": true, "compiled_code": "with listing as (\n\n    select Distinct ROOM_TYPE from AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__listing\n\n),\n\nroom as (\n\n    select Distinct \n    Case When ROOM_TYPE = 'Entire home/apt' Then 1\n        When ROOM_TYPE = 'Private room' Then 2\n        When ROOM_TYPE = 'Shared room' Then 3\n        When ROOM_TYPE = 'Hotel room' Then 4\n        End CODE_ROOM_TYPE,\n    ROOM_TYPE \n    from listing\n\n)\n\nselect * from room", "relation_name": "AIRBNB_BI_DEV.BI_SILVER.int_d_type_room", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:48.690560Z", "completed_at": "2025-12-02T10:04:48.704093Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:48.708334Z", "completed_at": "2025-12-02T10:04:49.290672Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6001121997833252, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-26df-0017-bec30009f95e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.int_f_location", "compiled": true, "compiled_code": "with listing as (\n\n    select ID, \n\t\tPRICE,\n\t\tROOM_TYPE,\n\t\tVILLE,\n\t\tLATITUDE,\n\t\tLONGITUDE,\n\t\tNUMBER_OF_REVIEWS,\n\t\tREVIEW_SCORES_ACCURACY,\n\t\tREVIEW_SCORES_CHECKIN,\n\t\tREVIEW_SCORES_CLEANLINESS,\n\t\tREVIEW_SCORES_COMMUNICATION,\n\t\tREVIEW_SCORES_LOCATION,\n\t\tREVIEW_SCORES_RATING,\n\t\tREVIEW_SCORES_VALUE \n\tfrom AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__listing\n\twhere FG_DER_VER = 1\n\n),\n\nliste as (\n\n\tSelect ID, \n\tCase When PRICE <= 50 Then 1\n         When PRICE <= 100 Then 2\n         When PRICE <= 200 Then 3\n         When PRICE <= 500 Then 4\n         When PRICE <= 1000 Then 5\n        Else 6\n        End CODE_PRICE,\n\tCase When ROOM_TYPE = 'Entire home/apt' Then 1\n\t\tWhen ROOM_TYPE = 'Private room' Then 2\n\t\tWhen ROOM_TYPE = 'Shared room' Then 3\n\t\tWhen ROOM_TYPE = 'Hotel room' Then 4\n\t\tEnd CODE_ROOM_TYPE,\n    Case When VILLE = 'Bordeaux' Then 1\n\t\t When VILLE = 'Lyon' Then 2\n\t\t When VILLE = 'Paris' Then 3\n\t\t When VILLE = 'Pays Basque' Then 4\n\tEnd CODE_VILLE,\n\tLATITUDE,\n\tLONGITUDE,\n\tNUMBER_OF_REVIEWS,\n\tREVIEW_SCORES_ACCURACY,\n\tREVIEW_SCORES_CHECKIN,\n\tREVIEW_SCORES_CLEANLINESS,\n\tREVIEW_SCORES_COMMUNICATION,\n\tREVIEW_SCORES_LOCATION,\n\tREVIEW_SCORES_RATING,\n\tREVIEW_SCORES_VALUE\n    from listing\n\n)\n\nselect * from liste", "relation_name": "AIRBNB_BI_DEV.BI_SILVER.int_f_location", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:49.301165Z", "completed_at": "2025-12-02T10:04:49.310200Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:49.310712Z", "completed_at": "2025-12-02T10:04:50.340786Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0501136779785156, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-26df-0017-bec30009f962"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.f_nb_location", "compiled": true, "compiled_code": "with listing as (\n\n    select ID, NUMBER_OF_REVIEWS, CODE_PRICE, CODE_VILLE, CODE_ROOM_TYPE \n    from AIRBNB_BI_DEV.BI_SILVER.int_f_location\n\n),\n\nprice as (\n\n    Select CODE_TR_PRICE,\n    TR_PRICE \n    from AIRBNB_BI_DEV.BI_SILVER.int_d_price\n\n),\n\ntown as (\n\n    Select CODE_VILLE, VILLE \n    from AIRBNB_BI_DEV.BI_SILVER.int_d_town\n\n),\n\nroom as (\n\n    Select CODE_ROOM_TYPE, ROOM_TYPE \n    from AIRBNB_BI_DEV.BI_SILVER.int_d_type_room\n\n),\n\nagg as (\n\n    Select TR_PRICE, VILLE, ROOM_TYPE, Count(Distinct ID) NB_AIRBNB, Sum(NUMBER_OF_REVIEWS) NB_REVIEW\n    From listing \n    Inner Join price On price.CODE_TR_PRICE = listing.code_price\n    Inner Join town On town.CODE_VILLE = listing.code_ville\n    Inner Join room On room.CODE_ROOM_TYPE = listing.code_room_type\n    Group By TR_PRICE, VILLE, ROOM_TYPE\n\n)\n\n\nselect * from agg", "relation_name": "AIRBNB_BI_DEV.BI_GOLD.f_nb_location", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-02T10:04:47.953312Z", "completed_at": "2025-12-02T10:04:47.965336Z"}, {"name": "execute", "started_at": "2025-12-02T10:04:47.965336Z", "completed_at": "2025-12-02T10:05:57.862926Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 69.91331839561462, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0c75c-0207-2aa5-0017-bec3000ab65e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.airbnb.int_f_avis_s_1", "compiled": true, "compiled_code": "\n\nwith review_s_1 as (\n\n    select * from AIRBNB_BI_DEV.BI_BRONZE.stg_airbnb__review_S_1\n\n),\n\navis_s_1 as (\n\n    select \n    LISTING_ID,\n    ID,\n    DATE,\n    COMMENTS,\n    analyse_json_note,\n    analyse_json_note:global::string AS global,\n    analyse_json_note:explication_global::string AS explication_global,\n    analyse_json_note:prix::string AS prix,\n    analyse_json_note:explication_prix::string AS explication_prix,\n    analyse_json_note:localisation::string AS localisation,\n    analyse_json_note:explication_localisation::string AS explication_localisation,\n    analyse_json_note:qualite::string AS qualite,\n    analyse_json_note:explication_qualite::string AS explication_qualite\n    from \n    (\n        select\n        LISTING_ID,\n        ID,\n        DATE,\n        COMMENTS,\n        TRY_PARSE_JSON(\n            REPLACE(REPLACE(\n                SNOWFLAKE.CORTEX.COMPLETE(\n                    'mistral-large',\n                    'Donner une note de 1 \u00e0 5 pour ces commentaires de location de Airbnb. Je veux des r\u00e9ponses en fran\u00e7ais'\n                    || 'La r\u00e9ponse doit \u00eatre un seul objet JSON, rien d\u2019autre, valide, sans retour chariot, '\n                    || 'avec ces 8 champs en fran\u00e7ais : global, explication_global, prix, explication_prix, '\n                    || 'localisation, explication_localisation, qualite, explication_qualite. '\n\t\t\t\t\t|| 'global, prix,localisation et qualite doivent \u00eatre uniquement des nombre entre 1 et 5'\n                    || 'Si la note n''est pas calculable, mettre null'\n                    || 'Voici le commentaire: ' || COMMENTS\n                ),\n            '\\n', ''), '\\r', '')\n        ) AS analyse_json_note\n        from review_s_1\n\t    Where FG_DER_VER = 1\n    ) review_notes\n\n)\n\nselect * from avis_s_1", "relation_name": "AIRBNB_BI_DEV.BI_SILVER.int_f_avis_s_1", "batch_results": null}], "elapsed_time": 89.55965995788574, "args": {"favor_state": false, "partial_parse_file_diff": true, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "static_parser": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "introspect": true, "require_generic_test_arguments_property": true, "state_modified_compare_vars": false, "invocation_command": "dbt run --profiles-dir . --target dev", "skip_nodes_if_on_run_start_fails": false, "show_resource_report": false, "upload_to_artifacts_ingest_api": false, "write_json": true, "profiles_dir": ".", "use_fast_test_edges": false, "cache_selected_only": false, "project_dir": "C:\\Users\\BenoitOTTAVI\\DBT\\dbt-core\\airbnb", "printer_width": 80, "print": true, "vars": {}, "target": "dev", "defer": false, "log_path": "C:\\Users\\BenoitOTTAVI\\DBT\\dbt-core\\airbnb\\logs", "require_all_warnings_handled_by_warn_error": false, "log_level_file": "debug", "strict_mode": false, "use_colors_file": true, "show_all_deprecations": false, "empty": false, "log_file_max_bytes": 10485760, "log_level": "info", "indirect_selection": "eager", "log_format_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "macro_debugging": false, "log_format": "default", "source_freshness_run_project_hooks": true, "validate_macro_args": false, "version_check": true, "require_resource_names_without_spaces": true, "exclude": [], "require_yaml_configuration_for_mf_time_spines": false, "which": "run", "quiet": false, "state_modified_compare_more_unrendered_values": false, "partial_parse": true, "use_colors": true}}